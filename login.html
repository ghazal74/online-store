<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>login</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon -->
    
    <!-- CSS 
    ========================= -->


    <!-- Plugins CSS -->
    <link rel="stylesheet" href="plugins.css">
    
    <!-- Main Style CSS -->
    <link rel="stylesheet" href="style.css">

</head>

<body>

    <!-- hash section -->
    <div class="hash">
        <div class="container5">Free Returns: For First 40 Days</div>
        <li class="top_links"><a href="#">Sign In <i class="ion-chevron-down"></i></a>
            <ul class="dropdown_links">
                <li><a href="#">Sign In</a></li>
            </ul>
        </li>
        <li class="language"><a href="#"><img src="img/language.png" alt=""> English <i class="ion-chevron-down"></i></a>
            <ul class="dropdown_language">
                <li><a href="#"><img src="img/language2.png" alt="">Arabic</a></li>
            </ul>
        </li>
        <div class="currency">
            <a href="#">USD <i class="ion-chevron-down"></i></a>
            <ul class="dropdown_currency">
                <li><a href="#">SAR</a></li>
                <li><a href="#">AED</a></li>
                <li><a href="#">UED</a></li>
            </ul>
        </div>
    
    </div>
                     
    
    <!-- customer login start -->
    <div class="customer_login">
        <div class="container">
            <div class="row">
                <!-- Login Area -->
                <div class="col-lg-6 col-md-6">
                    <div class="account_form">
                        <h2>Login</h2>
                        <form action="#">
                            <p>
                                <label for="username">Username or email <span>*</span></label>
                                <input type="email" id="username" name="username" required>
                            </p>
                            <p>
                                <label for="password">Password <span>*</span></label>
                                <input type="password" id="password" name="password" required>
                            </p>
                            <div class="login_submit">
                                <a href="#">Lost your password?</a>
                                <label for="remember">
                                    <input id="remember" type="checkbox">
                                    Remember me
                                </label>
                                <button type="submit">Login</button>
                            </div>
                        </form>
                    </div>
                </div>
    
                <!-- Register Area -->
                <div class="col-lg-6 col-md-6">
                    <div class="account_form register">
                        <h2>Register</h2>
                        <form action="#">
                            <p>
                                <label for="email">Email address <span>*</span></label>
                                <input type="email" id="email" name="email" required>
                            </p>
                            <p>
                                <label for="reg_password">Password <span>*</span></label>
                                <input type="password" id="reg_password" name="reg_password" required>
                            </p>
                            <div class="login_submit">
                                <button type="submit">Register</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- customer login end -->

    <!-- customer login end -->

            <!--footer content-->
            <footer class="footer">
                <div class="container7">
                    <div class="column">
                        <h3>Contact Information</h3>
                        <p>ğŸ“ Phone: 0528686321</p>
                        <p>âœ‰ï¸ Email: Info@almotabaed.com</p>
                    </div>
                    <div class="column">
                        <h3>Important Links</h3>
                        <a href="#">Privacy Policy</a>
                        <br>
                        <a href="#">Terms of Use</a>
                    </div>
                    <div class="column social">
                        <h3>Follow Us</h3>
                        <a href="#"> Facebook</a>
                        <br>
                        <a href="#"> Twitter</a>
                        <br>
                        <a href="#"> Instagram</a>
                    </div>
                </div>
                <div class="copyright">
                    &copy; 2025 All Rights Reserved | KGM Marketing
                </div>
            </footer>

    <!--footer area end-->

<!-- JS
============================================ -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
            // Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ù†Ù…Ø§Ø°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„
            const loginForm = document.querySelector('.account_form form[action="#"]');
            const registerForm = document.querySelector('.account_form.register form[action="#"]');

            const API_URL = "https://172.23.128.1:5000"; // ğŸ”¹ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„Ø³ÙŠØ±ÙØ±

            // âœ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            if (loginForm) {
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('username').value.trim();
                    const password = document.getElementById('password').value.trim();

                    console.log("ğŸ” Sending login data:", { email, password });

                    try {
                        const res = await fetch(`${API_URL}/login`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ email, password })
                        });

                        if (!res.ok) {
                            const errorData = await res.json(); // âœ… ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† `res.json()` Ù„Ø§ ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¤Ù‡ Ø¥Ù„Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©
                            throw new Error(errorData.message || "Login failed");
                        }

                        const data = await res.json(); // âœ… Ø§Ù„Ø¢Ù† `data` Ù…Ø¶Ù…ÙˆÙ† Ø§Ù„ØªØ¹Ø±ÙŠÙ Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
                        console.log("ğŸ›  Server Response:", data);

                        localStorage.setItem('token', data.token);
                        window.location.href = "index.html";
                    } catch (error) {
                        alert(`âŒ Login failed: ${error.message}`);
                        console.error("ğŸš¨ Error:", error);
                    }
                });
            }

            // âœ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
            if (registerForm) {
                registerForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('email').value.trim();
                    const password = document.getElementById('reg_password').value.trim();

                    if (!email || !password) {
                        alert("âŒ Please enter a valid email and password.");
                        return;
                    }

                    try {
                        const res = await fetch(`${API_URL}/register`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ email, password })
                        });

                        if (!res.ok) {
                            const errorData = await res.json(); // âœ… Ù†ÙØ³ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ ÙƒÙ…Ø§ ÙÙŠ `login`
                            throw new Error(errorData.message || "Registration failed");
                        }

                        const data = await res.json();
                        localStorage.setItem('token', data.token);
                        window.location.href = "index.html";
                    } catch (error) {
                        alert(`âŒ Registration failed: ${error.message}`);
                        console.error("ğŸš¨ Error:", error);
                    }
                });
            }
        });




        if (document.querySelector("#remember").checked) {
                localStorage.setItem('token', data.token);
            } else {
                sessionStorage.setItem('token', data.token);
            }

            if (localStorage.getItem('token') || sessionStorage.getItem('token')) {
                    window.location.href = "home.html";
                }

    document.addEventListener("DOMContentLoaded", function () {
        const token = localStorage.getItem("token") || sessionStorage.getItem("token");

        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„Ù‹Ø§ØŒ Ù‚Ù… Ø¨ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ login.html
        if (!token && window.location.pathname !== "/login.html") {
            window.location.href = "login.html";
        }
    });
    document.getElementById("logout").addEventListener("click", function () {
        localStorage.removeItem("token");  // Ø­Ø°Ù Ø§Ù„ØªÙˆÙƒÙ† Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ†
        sessionStorage.removeItem("token");
        window.location.href = "login.html";  // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    });


 </script>
<!-- Plugins JS -->
<script src="plugins.js"></script>

<!-- Main JS -->



</body>

</html>